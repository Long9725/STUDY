## 목차

1. [SQL이란?](#sql이란)
2. [데이터 정의어](#데이터-정의어)
3. [데이터 조작어](#데이터-조작어)
4. [데이터 제어어](#데이터-제어어)
5. [References](#references)

## SQL이란?
Structured query language의 약자로, 관계 데이터베이스를 위한 표준 질의어이다. 비절차적 데이터 언어이다.

+ 대화식 SQL: DBMS에 직접 접근해 질의를 작성하여 실행한다.
+ 삽입 SQL: 프로그래밍 언어로 작성된 응용 프로그램에 삽입한다.

+ SQL 질의문은 세미콜론으로 문장의 끝을 표시한다.
+ SQL 질의문은 대소문자를 구분하지 않는다.
+ []의 내용은 생략이 가능하다.

### 데이터 타입

![](../image/sql/data%20type.jpeg)

## 데이터 정의어
DDL, 테이블을 생성하고 변경•제거하는 기능을 제공한다.

<details><summary>CREATE TABLE</summary>

### CREATE TABLE
테이블을 생성하는 명령어이다.

    CREATE TABLE 테이블_이름 (
        속성_이름 데이터_타입 [NOT NULL] [DEFAULT 기본_값]
        [PRIMARY KEY (속성_리스트)]
        [UNIQUE (속성_리스트)]
        [FOREIGN KEY (속성_리스트) REFERENCES 테이블_이름(속성_리스트]
            [ON DELETE 옵션] [ON UPDATE 옵션]
        [CONSTRAINT 이름] [CHECK(조건)]
    );

+ 테이블을 구성하는 각 속성의 이름, 데이터 타입, 기본 제약 사항을 정의한다.
    + 속성: 테이블을 구성하는 각 속성의 데이터 타입을 선택한 다음, 널 값 허용 여부와 기본값 필요 여부를 결정한다.
        + NOT NULL: 속성이 널값을 허용하지 않음을 의미하는 키워드이다.
        + DEFAULT: 속성의 기본값을 지정하는 키워드이다. 문자열이나 날짜 데이터는 작은 따옴표로 묶어서 표현한다. 대소문자를 구분한다.
+ 기본키, 대체키, 외래키를 정의할 수 있다.
    + PRIMARY KEY: 기본키를 지정하는 키워드이다.
    + UNIQUE: 대체키를 지정하는 키워드이다. 대체키로 지정되는 속성의 값은 유일성을 가지며, 기본키와 달리 널 값이 허용된다.
    + FOREIGN KEY: 외래키를 지정하는 키워드이다. 외래키가 어떤 테이블의 무슨 속성을 참조하는지 REFERENCES 키워드 다음에 제시한다. 참조 무결성 제약조건 유지를 위해서, 참조되는 테이블에서 투플 삭제시 처리 방법을 지정하는 옵션이 있다.
        + ON DELETE NO ACTION: 투플을 삭제하지 못하게 한다.
        + ON DELETE CASCADE: 관련 투플을 함께 삭제한다.
        + ON DELETE SET NULL: 관련 투플의 외래키 값을 NULL로 변경한다.
        + ON DELETE SET DEFAULT: 관련 투플의 외래키 값을 미리 지정한 기본 값으로 변경한다.
+ 데이터 무결성을 위한 제약조건을 정의한다.
    + CHECK: 테이블에 정확하고 유효한 데이터를 유지하기 위해서, 특정 속성에 대한 제약조건을 지정한다. CONSTARINT 키워드와 함께 고유 이름을 부여할 수 있다.

</details>

<details><summary>ALTER TABLE</summary>

### ALTER TABLE
테이블에 관한 내용을 변경하는 명령어이다.

+ 테이블에 새로운 속성을 추가한다.

    ALTER TABLE 테이블_이름
     ADD 속성_이름 데이터_타입 [NOT NULL] [DEFAULT 기본_값];

+ 기존 속성을 삭제한다.

    ALTER TABLE 테이블_이름 DROP COLUMN 속성_이름;

    + 만약 삭제할 속성과 관련돈 제약 조건이 있다면, 속성 삭제가 수행되지 않거나 관련된 제약 조건을 먼저 삭제해야한다.

+ 새로운 제약 조건을 추가한다.

    ALTER TABLE 테이블_이름 ADD CONSTRAINT 제약조건_이름 제약조건_내용;

+ 기존 제약조건을 삭제한다.

    ALTER TABLE 테이블_이름 DROP CONSTRAINT 제약조건_이름;

</details>

<details><summary>DROP   TABLE</summary>

### DROP TABLE
테이블을 삭제하는 명령어이다.

    DROP TABLE 테이블_이름;

</details>



## 데이터 조작어
DML, 테이블에 새 데이터를 삽입하거나, 테이블에 저장된 데이터를 수정•삭제•검색하는 기능을 제공한다.

<details><summary>SELECT TABLE</summary>

### SELECT
테이블의 레코드를 선택한다. 
#### 일반 검색

    SELECT [All | DISTINCT] 속성_리스트 FROM 테이블_리스트;

+ SELECT 키워드와 함께 검색하고 싶은 속성의 이름을 나열한다. 
+ FROM 키워드와 함께 검색하고 싶은 속성이 있는 테이블의 이름을 나열한다.
+ ALL: 결과 테이블이 투플의 중복을 허용하도록 지정한다.
+ DISTINCT: 결과 테이블이 투프르이 중복이 허용되지 않도록 한다.

    SELECT [All | DISTINCT] 속성_리스트 [AS 새로운 속성 명]FROM 테이블_리스트;

+ AS: 결과 테이블에서 속성의 이름을 바꾸어 출력 가능하다. 새로운 이름에 공백이 포함되어 있으면 큰따옴표나 작은따옴표로 묶어주어야 한다.

    SELECT [All | DISTINCT] 속성_리스트 [산술식] [AS 새로운 속성 명]
    FROM 테이블_리스트;

+ 산술식: 속성의 이름과 +, -, *, / 등의 산술 연산자와 상수로 구성된다. 속성의 값이 실제로 변경되는 것은 아니고, 결과 테이블에서만 계산된 결과 값이 출력된다.

#### 조건 검색
조건을 만족하는 데이터만 검색한다.

    SELECT [All | DISTINCT] 속성_리스트 [산술식] [AS 새로운 속성 명]
    FROM 테이블_리스트
    [ WHERE 조건 ];

WHERE 키워드와 함께 비교 연산자와 논리 연산자를 이용한 검색 조건을 제시한다.

+ LIKE: 부분적으로 일치하는 데이터를 검색한다. 문자열을 이용하는 조건에만 LIKE 키워드를 사용할 수 있다.
    + %: 0개 이상의 문자
    + _: 1개의 문자
    + LIKE '데이터%": 데이터로 시작하는 문자열
    + LIKE '%데이터": 데이터로 끝나는 문자열
    + LIKE '%데이터%": 데이터 가 포함된 문자열
    + LIKE '데이터___": 데이터로 시작하는 6자 길이의 문자열
    + LIKE '__한%": 세번째 글자가 '한'인 문자열

+ IS NULL: 특정 속성의 값이 널 값인지를 비교한다.
+ IS NOT NULL: 특정 속성의 값이 널값이 아닌지를 비교한다.

널 값은 다른 값과 크기를 비교하면 결과가 모두 거짓이 된다.

#### 정렬 검색
ORDER BY 키워드를 이용해서 결과 테이블 내용을 사용자가 원하는 순서로 출력한다. 정렬 기준이 되는 속성과 정렬 방식을 지정한다.

    SELECT [All | DISTINCT] 속성_리스트 [산술식] [AS 새로운 속성 명]
    FROM 테이블_리스트
    [ WHERE 조건 ]
    [ ORDER BY 속성_리스트[ASC | DESC] ];

+ 오름차순(기본) - ASC / 내림차순 - DESC
+ 널 값은 오름차순에서는 제일 마지막에 출력되고, 내림차순에서는 제일 먼저 출력된다.
+ 여러 기준에 따라 정렬하려면 정렬 기준이 되는 속성을 차례대로 제시한다.

#### 집계 함수
Aggregate function, column function이라고도 한다. 특정 속성 값을 통계적으로 검색한 결과를 검색하기 위해 집계 함수를 이용한다. 개수(COUNT), 합계(SUM), 평균(AVG), 최댓값(MAX), 최솟값(MIN)의 계산 기능을 제공한다.

+ 널인 속성 값은 제외하고 계산한다.
+ WHERE 절에서는 사용할 수 없고, SELECT 절이나 HAVING 절에서만 사용 가능하다.
+ COUNT, MAX, MIN - 모든 데이터
    + COUNT를 사용할 때, 정확한 개수를 계산하기 위해서는 보통 기본키 속성이나 *를 이용한다.
+ SUM, AVG - 숫자 데이터

#### 그룹별 검색
GROUP BY 키워드를 이용해 특정 속성의 값이 같은 투플을 모아 그룹을 만들고, 그룹별로 검색한다. 

    SELECT [All | DISTINCT] 속성_리스트 [산술식] [AS 새로운 속성 명]
    FROM 테이블_리스트
    [ WHERE 조건 ]
    [ GROUB BY 속성_리스트 [HAVING 조건] ]
    [ ORDER BY 속성_리스트[ASC | DESC] ];


+ GROUP BY 키워드와 함께 그룹을 나누는 기준이 되는 속성을 지정한다.
+ HAVING 키워드를 함께 이용해 그룹에 대한 조건을 지정한다.
+ 그룹을 나누는 기준이 되는 속성을 SELECT 절에도 작성하는 것이 좋다.

#### 조인 검색
여러 개의 테이블을 연결하여 데이터를 검색하는 것이다. 조인 검색을 위해 테이블을 연결해주는 조인 속성을 지정한다. 속성의 이름은 달라도 되지만, 도메인은 같아야 한다. 일반적으로 외래키를 사용한다.

+ FROM 절에 검색에 필요한 모든 테이블을 나열한다.
+ WHERE 절에 조인 속성이 같아야 함을 의미하는 조인 조건을 제시한다.
+ 속성 이름 앞에 해당 속성이 소속된 테이블의 이름을 표시한다.
+ 테이블의 이름을 대신하는 단순한 별명을 제시하여 질의문을 작성하는 것도 좋다.

#### 부속 질의문
SELECT 문 안에 또 다른 SELECT 문을 포함하는 질의이다. 주 질의문과 부속 질의문으로 나눈다. 부속 질의문을 먼저 수행하고, 그 결과를 이용해 상의 질의문을 수행한다. 따라서 이 둘을 연결하는 연산자가 필요하다.

+ 부속 질의문은 괄호로 묶어서 작성하며, ORDER BY 절을 사용할 수 없다.
+ 단일 행 부속 연산자: 하나의 행을 결과로 반환한다.
    + 비교 연산자 사용 가능
+ 다중 행 부속 연산자: 하나 이상의 행을 결과로 반환한다.
    + 비교 연산자 사용 불가능
    + IN, NOT IN, EXISTS, NOT EXISTS, ALL, ANY 또는 SOME 사용 가능
    + IN: 부속 질의문 결과 중, 일치하는 것이 있으면 검색 조건이 참이다.
    + NOT IN: 부속 질의문 결과 중, 일치하는 것이 없으면 검색 조건이 참이다.
    + EXISTS: 부속 질의문 결과값이 하나라도 존재하면 검색 조건이 참이다.
    + NOT EXISTS: 부속 질의문 결과값이 하나라도 존재하지 않으면 검색 조건이 참이다.
    + ALL: 부속 질의문 결과값 모두와 비교한 결과가 참이면 검색 조건을 만족한다. 비교 연산자와 함께 사용한다.
    + ANY 또는 SOME: 부속 질의문 값 중 하나라도 비교한 결과가 참이면 검색 조건을 만족한다. 비교 연산자와 함께 사용한다.

</details>

<details><summary>INSERT TABLE</summary>

### INSERT
테이블에 데이터를 삽입한다.

    INSERT 
    INTO 테이블_이름[(속성_리스트)]
    VALUES (속성_리스트);

+ INTO 키워드와 함께 투플을 삽입할 테이블의 이름과 속성의 이름을 나열한다.
    + 속성 리스트를 생략하면 테이블을 정의할 때, 지정한 속성의 순서대로 값이 삽입된다.
+ VALUES 키워드와 함께 삽입할 속성 값들을 나열한다.
+ INTO 절의 속성 이름과 VALUES 절의 속성 값은 순서대로 일대일 대응되어야 한다.

부속 질의문을 이용해서 데이터를 삽입할 수 있다.

    INSERT 
    INTO 테이블_이름[(속성_리스트)]
    SELECT 문;

</details>

<details><summary>UPDATE 
TABLE</summary>

### UPDATE
테이블에 저장된 투플에서 특정 속성의 값을 수정한다.

    UPDATE 테이블_이름
    SET 속성_이름1 = 값1, 속성_이름2 = 값2, ...
    [WHERE 조건];

+ SET 키워드 다음에 속성 값을 어떻게 수정할 것인지를 지정한다.
+ WHERE 절에 제시된 조건을 만족하는 투플에 대해서만 속성 값을 수정한다.
    + WHERE 절을 생략하면 테이블에 존재하는 모든 투플을 대상으로 수정한다. 대참사가 날 확률이 높다.
        
</details>
<details><summary>DELETE TABLE</summary>

### DELECT
테이블에 저장된 데이터를 삭제한다.

    DELETE
    FROM 테이블_이름
    [WHERE 조건];

+ WHERE 절에 제시한 조건을 만족하는 투플만 삭제한다.
    + WHERE 절을 생략하면 테이블에 존재하는 모든 투플을 삭제해서 빈 테이블이 된다. 대참사가 날 확률이 매우 높다.

</details>


## 데이터 제어어
DCL, 보안을 위해 데이터에 대한 접근 및 사용 권한을 사용자별로 부여하거나 취소하는 기능을 제공한다.  



## References
* 2022 봄 데이터베이스 강의